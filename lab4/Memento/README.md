# Memento

### Основні компоненти шаблону

- **Originator**: Клас [`TextDocument`](TextDocument.cs), який відповідає за створення та відновлення знімків стану.
- **Memento**: Внутрішній клас [`TextDocument.Memento`](TextDocument.cs#L45-L53), який зберігає стан документа.
- **Caretaker**: Клас [`TextEditor`](TextEditor.cs), який керує історією знімків, зберігаючи їх у черзі.

## Структура коду

### 1. Клас [`TextDocument`](TextDocument.cs) (Originator)

- **Опис**: Представляє текстовий документ, який підтримує операції введення, видалення та очищення тексту, а також створення і відновлення знімків стану.
- **Поля**:
  - [`_content`](TextDocument.cs#L11) (string): Зберігає текстовий вміст документа.
- **Методи**:
  - [`Write(string text)`](TextDocument.cs#L13-L16): Додає текст до вмісту документа.
  - [`Delete()`](TextDocument.cs#L18-L24): Видаляє останній символ із вмісту, якщо документ не порожній.
  - [`Erase()`](TextDocument.cs#L25-L28): Очищає весь вміст документа.
  - [`GetContent()`](TextDocument.cs#L30-L33): Повертає поточний вміст документа.
  - [`Save()`](TextDocument.cs#L35-L38): Створює знімок (`Memento`) поточного стану документа.
  - [`Restore(Memento memento)`](TextDocument.cs#L40-L43): Відновлює стан документа з переданого знімка.
- **Внутрішній клас** [`Memento`](TextDocument.cs#L45-L53):
  - Зберігає стан документа (вміст `_content`) у момент створення.
  - Поле `_state` (string): Зберігає копію вмісту документа.
  - Конструктор: Ініціалізує `_state` переданим станом.
  - Модифікатор `internal` обмежує доступ до `_state`, дозволяючи використовувати його лише в межах `TextDocument` і пов’язаних класів.

### 2. Клас [`TextEditor`](TextEditor.cs) (Caretaker)

- **Опис**: Реалізує інтерфейс текстового редактора, який обробляє введення користувача, керує історією змін і відображає вміст документа.
- **Поля**:
  - [`_document` (`TextDocument`)](TextEditor.cs#L11): Екземпляр документа, з яким працює редактор.
  - [`_history` (`Queue<TextDocument.Memento>`)]: Черга для зберігання знімків стану документа.
  - [`_maxLength`](TextEditor.cs#L13) (const int): Обмеження на кількість збережених знімків (20), щоб запобігти надмірному використанню пам’яті.
- **Методи**:
  - [`Start()`](TextEditor.cs#L15-L50): Головний цикл редактора, який обробляє введення клавіш (`Ctrl+Z` для скасування, `Escape` для виходу, `Backspace` для видалення, `Enter` для нового рядка, інші клавіші для введення тексту).
  - [`Type(string text)`](TextEditor.cs#L51-L59): Зберігає поточний стан документа в історії та додає текст.
  - [`Delete()`](TextEditor.cs#L61-L69): Зберігає поточний стан і видаляє останній символ.
  - [`Clear()`](TextEditor.cs#L71-L75): Зберігає поточний стан і очищає документ.
  - [`Undo()`](TextEditor.cs#L77-L86): Відновлює останній збережений стан із черги, видаляючи його з історії.
  - [`Show()`](TextEditor.cs#L88-L99): Очищає консоль, виводить вміст документа та встановлює позицію курсору для продовження введення.

## Як працює шаблон Memento

1. **Збереження стану**:

   - Перед кожною зміною документа (`Type`, `Delete`, `Clear`) викликається метод `Save`, який створює знімок (`Memento`) поточного вмісту документа.
   - Знімок додається до черги `_history` у `TextEditor`. Якщо черга досягає максимальної довжини (`_maxLength`), найстаріший знімок видаляється (`Dequeue`).

2. **Відновлення стану**:

   - При натисканні `Ctrl+Z` метод `Undo` отримує останній знімок із черги `_history`, відновлює стан документа через `Restore` і видаляє використаний знімок із черги.
   - Якщо черга порожня, скасування не виконується.

3. **Керування історією**:

   - Використання `Queue<TextDocument.Memento>` дозволяє зберігати послідовність станів у порядку їх створення.
   - Обмеження `_maxLength` запобігає накопиченню надмірної кількості знімків, оптимізуючи використання пам’яті.

## Особливості реалізації

- **Інкапсуляція**: Внутрішній клас `Memento` із модифікатором `internal` забезпечує доступ до стану лише для `TextDocument` і `TextEditor`, зберігаючи інкапсуляцію.
- **Обмеження історії**: Використання черги з максимальним розміром (`_maxLength = 20`) запобігає надмірному використанню пам’яті.
- **Інтерактивність**: Редактор обробляє введення в реальному часі, підтримуючи стандартні дії (введення, видалення, скасування) і коректно позиціонуючи курсор у консолі.
- **Кодування**: Використання UTF-8 у консолі (встановлюється в `Program`) забезпечує коректне відображення спеціальних символів, таких як емодзі.

