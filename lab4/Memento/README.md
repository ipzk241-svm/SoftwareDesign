#Memento

##Memento

### Основні компоненти шаблону

- **Originator**: Клас `TextDocument`, який відповідає за створення та відновлення знімків стану.
- **Memento**: Внутрішній клас `TextDocument.Memento`, який зберігає стан документа.
- **Caretaker**: Клас `TextEditor`, який керує історією знімків, зберігаючи їх у черзі.

## Структура коду

### 1. Клас `TextDocument` (Originator)

- **Опис**: Представляє текстовий документ, який підтримує операції введення, видалення та очищення тексту, а також створення і відновлення знімків стану.
- **Поля**:
  - `_content` (string): Зберігає текстовий вміст документа.
- **Методи**:
  - `Write(string text)`: Додає текст до вмісту документа.
  - `Delete()`: Видаляє останній символ із вмісту, якщо документ не порожній.
  - `Erase()`: Очищає весь вміст документа.
  - `GetContent()`: Повертає поточний вміст документа.
  - `Save()`: Створює знімок (`Memento`) поточного стану документа.
  - `Restore(Memento memento)`: Відновлює стан документа з переданого знімка.
- **Внутрішній клас** `Memento`:
  - Зберігає стан документа (вміст `_content`) у момент створення.
  - Поле `_state` (string): Зберігає копію вмісту документа.
  - Конструктор: Ініціалізує `_state` переданим станом.
  - Модифікатор `internal` обмежує доступ до `_state`, дозволяючи використовувати його лише в межах `TextDocument` і пов’язаних класів.

### 2. Клас `TextEditor` (Caretaker)

- **Опис**: Реалізує інтерфейс текстового редактора, який обробляє введення користувача, керує історією змін і відображає вміст документа.
- **Поля**:
  - `_document` (`TextDocument`): Екземпляр документа, з яким працює редактор.
  - `_history` (`Queue<TextDocument.Memento>`): Черга для зберігання знімків стану документа.
  - `_maxLength` (const int): Обмеження на кількість збережених знімків (20), щоб запобігти надмірному використанню пам’яті.
- **Методи**:
  - `Start()`: Головний цикл редактора, який обробляє введення клавіш (`Ctrl+Z` для скасування, `Escape` для виходу, `Backspace` для видалення, `Enter` для нового рядка, інші клавіші для введення тексту).
  - `Type(string text)`: Зберігає поточний стан документа в історії та додає текст.
  - `Delete()`: Зберігає поточний стан і видаляє останній символ.
  - `Clear()`: Зберігає поточний стан і очищає документ.
  - `Undo()`: Відновлює останній збережений стан із черги, видаляючи його з історії.
  - `Show()`: Очищає консоль, виводить вміст документа та встановлює позицію курсору для продовження введення.

## Як працює шаблон Memento

1. **Збереження стану**:

   - Перед кожною зміною документа (`Type`, `Delete`, `Clear`) викликається метод `Save`, який створює знімок (`Memento`) поточного вмісту документа.
   - Знімок додається до черги `_history` у `TextEditor`. Якщо черга досягає максимальної довжини (`_maxLength`), найстаріший знімок видаляється (`Dequeue`).

2. **Відновлення стану**:

   - При натисканні `Ctrl+Z` метод `Undo` отримує останній знімок із черги `_history`, відновлює стан документа через `Restore` і видаляє використаний знімок із черги.
   - Якщо черга порожня, скасування не виконується.

3. **Керування історією**:

   - Використання `Queue<TextDocument.Memento>` дозволяє зберігати послідовність станів у порядку їх створення.
   - Обмеження `_maxLength` запобігає накопиченню надмірної кількості знімків, оптимізуючи використання пам’яті.

## Особливості реалізації

- **Інкапсуляція**: Внутрішній клас `Memento` із модифікатором `internal` забезпечує доступ до стану лише для `TextDocument` і `TextEditor`, зберігаючи інкапсуляцію.
- **Обмеження історії**: Використання черги з максимальним розміром (`_maxLength = 20`) запобігає надмірному використанню пам’яті.
- **Інтерактивність**: Редактор обробляє введення в реальному часі, підтримуючи стандартні дії (введення, видалення, скасування) і коректно позиціонуючи курсор у консолі.
- **Кодування**: Використання UTF-8 у консолі (встановлюється в `Program`) забезпечує коректне відображення спеціальних символів, таких як емодзі.

## Висновок

Реалізація шаблону Memento в цьому текстовому редакторі забезпечує ефективне збереження та відновлення станів документа, дозволяючи скасовувати зміни. Клас `TextDocument` діє як Originator, створюючи та відновлюючи знімки, тоді як `TextEditor` виконує роль Caretaker, керуючи чергою знімків. Обмеження розміру історії та інтерактивний інтерфейс роблять систему практичною та зручною для використання.
